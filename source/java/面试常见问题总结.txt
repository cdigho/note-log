2020-08-24  中信面试
1.InnoDB 索引方式 聚合索引 索引原理 实现方式

mysql 5.5.5 之前默认使用MyISAM 
聚合索引与非聚合索引使用的是B+树索引
聚合、聚集、聚簇索引表达的都是同一种意思
InnoDB使用的是聚簇索引使用B+数
MyISAM使用非聚簇索引
聚簇索引：数据行的物理顺序与列值（一般是主键的那一列）的逻辑顺序相同，一个表中只能拥有一个聚集索引。
非聚簇索引：该索引中索引的逻辑顺序与磁盘上行的物理存储顺序不同，一个表中可以拥有多个非聚集索引。

联合索引：首先不同的表不发使用索引，关联的字段创建索引
可以有一张冗余的表将关联表的字段信息放在一张表
任何的规范都是在特定情况下的某种妥协，脱离了这个环境，就不一定成立了。


2.redis看门狗

 长话短说实际是一个锁的续期操作
 
3.eureka和zookeeper

eureka 保证 AP  可用性和分区容错性 不保证节点一致性
zookeeper 保证 CP 一致性和容错性  不保证 可用性
当发生网络故障时 eureka有一只自我保护机制，如果在15分钟内超过85%的节点都没有心跳，
那就回认为发生了网络故障不会移除长时间没有心跳的服务，此时仍然能够接受新的注册与查询服务，但不会同步到其它节点
当网络故障恢复后会将新的注册信息同步到其它节点。
相比于zookeeper会使整个服务瘫痪

zookeeper重新选举过程过程30-120秒 选举过程中 服务不可用

eureka中若是某台服务器宕机，不会有类似于zookeeper的leader选举机制，客户端请求后会切换到可用节点，当宕机的服务恢复后，eureka在将其纳入服务器集群中
这其中eureka做的无非更新同步了一些服务注册信息而已

	ZooKeeper是分布式协调服务，它的职责是保证数据（注：配置数据，状态数据）在其管辖下的所有服务之间保持同步、一致
	在ZooKeeper中，如果在同一个网络分区（partition）的节点数（nodes）数达不到ZooKeeper选取Leader节点的“法定人数”时，它们就会从ZooKeeper中断开，当然同时也就不能提供Service发现服务了。
	zookeeper本意是保证节点的数据一致也就是CP强一致性，这样一来，就不可能得到一个既数据一致（CP）而且还保证可用性的（AP）服务
	
	假死：由于心跳超时（网络原因导致的）认为master死了，但其实master还存活着。
	脑裂：由于假死会发起新的master选举，选举出一个新的master，但旧的master网络又通了，导致出现了两个master ，有的客户端连接到老的master 有的客户端链接到新的master。
3.1延伸点CAP
Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。
    指的是在一个分布式系统中，Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可同时获得，最多只能两个。
一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（所有节点在同一时间的数据完全一致，越多节点，数据同步越耗时）（响应时间不能过长）
可用性（A）：负载过大后，集群整体是否还能响应客户端的读写请求。（服务一直可用，而且是正常响应时间）（机器不能过多）
分区容错性（P）：分区容忍性，就是高可用性，一个节点崩了，并不影响其它的节点（100个节点，挂了几个，不影响服务，越多机器越好）（机器不能过少）
CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容忍性是我们必须需要实现的。所以我们只能在一致性和可用性之间进行权衡

4.缓存穿透缓存击穿缓存雪崩
https://blog.csdn.net/qq_33479841/article/details/107778359
（1）缓存穿透：穿透，顾名思义，就是redis和数据库都没有，所以就是被穿透了啊；
（2）缓存击穿：击穿就是单点集中式访问，所有就被击穿了，这种肯定是某个key失效导致的啊；
（3）缓存雪崩：雪崩是大规模式的，普遍式和灾难式的，因此肯定是大规模失效状态，此处可记为大规模redis的key被干掉了，也就是大规模失效了。
穿透 redis mysql都没有 击穿了  在某一时间内大量访问  都没有 设置默认值null
击穿 某一key过期大量请求击穿了数据库  为热点数据延长失效时间
雪崩大量key过期   随机时间




Spring Boot Starter怎么实现的？如何自定义Starter？
Eureka，Nacos的区别？
Dubbo的注册中心如何实现？
Zuul和Gateway的区别？
Feign的底层原理？
谈谈Java锁升级和降级的理解？
CAS的基本原理？
CAS中的ABA问题解决方案？
volatile作用和特点？
volatile不保证原子性的后果是什么？
这是某大厂的面试，T6职级，30k薪资

